# Описание

Это репозиторий с выполнением лаб по курсу «Операционные системы» в
университете ИТМО ФПИиКТ СППО СПО.

Этот курс является экспериментальным в данный год.

Лабораторные работы основываются на модификации исходного кода ОС xv6, поэтому
репозиторий был форкнут и версии каждой ЛР будут помещаться в отдельные ветки:

- (см. [branches/main](https://github.com/e1turin/itmo-os-xv6-riscv))



# Комментарии от разработчиков

- (см. [README](/README))


# Задание

- (см. [TASK.md](/TASK.md))

- - -
# Комментарии

## Clangd

Чтобы нормально разрабатывать, т. е. с подсказками и линтерами, можно
подключить `clangd`. Он использует 'compilation database' в виде
`compile_commands.json` (см. [rizsotto/Bear](https://github.com/rizsotto/Bear)). 
Но проблема в том, что на Windows нет `bear`, а если сделать базу на linux, то пути до файлов на винде будут неверные. 

По факту, можно подправить все пути `sed`ом и тогда clangd сможет разрешать зависимости, но придется подправлять пути для каждого изменения процесса компиляции: добавил файлик — обнови базу. 

```bash
make clean && bear -- make && bear --append -- make qemu && (export WINXV6=D:/Projects/playground/xv6; cat compile_commands.json | sed "s|/home/xv6|$WINXV6|g" > compile_commands-fix.json && mv compile_commands-fix.json compile_commands.json)
```

Или можно добавить флаги компиляции для clangd (в [Makefile](./Makefile) для компиляции используются текущая директория `./`). Поэтому достаточно добавить файлик
`compile_flags.txt` в котором уже будет указан флаг `-I.`.

- Так же стоит добавить `.clangd` файл, чтобы показать корень проекта.
- Нельзя одновременно использовать `compile_commands.json` и
  `compile_flags.txt`.
- Когда `clangd` починят возможно нужно будет запускать `bear` 2 раза для
  `make` и `make qemu` (с флагом `--append`)


### Другой LSP

Можно использовать стандартный LSP vscode и находить ошибки при компиляции (vscode умеет парсить вывод компилятора), но на Windows будет сложнова-то.

