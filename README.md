# Описание

Это репозиторий с выполнением лаб по курсу «Операционные системы» в
университете ИТМО ФПИиКТ СППО СПО.

Этот курс является экспериментальным в данный год.

Лабораторные работы основываются на модификации исходного кода ОС xv6, поэтому
репозиторий был форкнут и версии каждой ЛР будут помещаться в отдельные ветки:

- (см. [branches/main](https://github.com/e1turin/itmo-os-xv6-riscv))



# Комментарии от разработчиков

- (см. [README](/README))


# Задание

- (см. [TASK.md](/TASK.md))

- - -
# Комментарии

## Clangd

Чтобы нормально разрабатывать, т. е. с подсказками и линтерами, можно
подключить `clangd`. Он использует 'compilation database' в виде
`compile_commands.json` (см. доку и
[rizsotto/Bear](https://github.com/rizsotto/Bear)). Но проблема в том, что на
Windows нет `bear`, а если сделать такую базу на linux (контейнер/WSL), то пути
до файлов на винде будут неверные. 

По факту, можно подправить все пути `sed`ом и тогда clangd сможет разрешать
зависимости, но придется подправлять пути для каждого изменения процесса
компиляции: добавил файлик — обнови базу. 

Для удобства можно пользоваться коммандой с переменной $WINXV6 (путь до каталога с сорцами
xv6 на Windows): 

```bash 
make clean && 
bear --output tmp-compdb.json -- make &&
bear --output tmp-compdb.json --append -- make qemu && 
(export WINXV6=D:/Projects/itmo-os-xv6-riscv; 
 cat tmp-compdb.json | sed "s|/home/xv6|$WINXV6|g" > compile_commands.json) 
```

Или можно добавить флаги компиляции для clangd (в [Makefile](./Makefile) для
компиляции используются текущая директория `./`). Поэтому достаточно добавить
файлик `compile_flags.txt` в котором уже будет указан флаг `-I.`.

- Нельзя одновременно использовать `compile_commands.json` и `compile_flags.txt` (первый главнее).
- Так же для удобства может потребоваться отключить ограничение количество
  отображаемых ошибок. Для этого нужно запустить `clangd` с флагом
  `-ferror-limit=0`. Его нужно добавить в пользовательскую конфигурацию LSP (см. доку).

### Другой LSP

Можно использовать стандартный LSP vscode и находить ошибки при компиляции
(vscode умеет парсить вывод компилятора), но на Windows будет сложновато.
